# 70+ Essential Windows CMD Commands

#### File and Directory Commands

1. **dir**\
   Lists files/directories.

```cmd
:: Basic: List all files with details
dir /a
:: Advanced: Find specific file types recursively
dir *.txt /s /p
```

2. **cd**\
   Changes directory.

```cmd
:: Basic: Navigate to a folder
cd C:\Users
:: Advanced: Switch to path with spaces
cd "C:\Program Files (x86)"
```

3. **mkdir/md**\
   Creates a directory.

```cmd
:: Basic: Create a single folder
mkdir Data
:: Advanced: Create nested folders
mkdir Parent\Child\Grandchild
```

4. **rmdir/rd**\
   Deletes a directory.

```cmd
:: Basic: Remove empty folder
rmdir Data
:: Advanced: Delete non-empty folder
rmdir /s /q Data
```

5. **del**\
   Deletes files.

```cmd
:: Basic: Delete a single file
del temp.txt
:: Advanced: Delete all .log files silently
del *.log /q
```

6. **copy**\
   Copies files.

```cmd
:: Basic: Copy a file
copy file.txt D:\Backup
:: Advanced: Copy multiple files with overwrite
copy *.txt D:\Backup /y
```

7. **xcopy**\
   Extended copy for files/directories.

```cmd
:: Basic: Copy a directory
xcopy Data D:\Backup
:: Advanced: Copy with hidden files and subdirs
xcopy Data D:\Backup /E /H
```

8. **move**\
   Moves/renames files.

```cmd
:: Basic: Move a file
move file.txt D:\Archive
:: Advanced: Rename multiple files
move *.txt *.bak
```

9. **attrib**\
   Changes file attributes.

```cmd
:: Basic: Hide a file
attrib +h secret.txt
:: Advanced: Make folder read-only and hidden
attrib +r +h Data
```

10. **ren**\
    Renames files/directories.

```cmd
:: Basic: Rename a file
ren old.txt new.txt
:: Advanced: Bulk rename files
ren *2023*.txt *2024*.txt
```

#### System Information Commands

11. **systeminfo**\
    Shows system configuration.

```cmd
:: Basic: Display OS name
systeminfo | find "OS Name"
:: Advanced: Export full info to file
systeminfo > sysinfo.txt
```

12. **hostname**\
    Shows computer name.

```cmd
:: Basic: Get hostname
hostname
:: Advanced: Log device name in script
echo %COMPUTERNAME% > device.txt
```

13. **ver**\
    Shows Windows version.

```cmd
:: Basic: Check version
ver
:: Advanced: Verify version in script
ver | findstr "10.0"
```

14. **set**\
    Manages environment variables.

```cmd
:: Basic: View all variables
set
:: Advanced: Add custom path
set PATH=%PATH%;C:\Tools
```

15. **wmic**\
    Performs system admin tasks.

```cmd
:: Basic: Get CPU info
wmic cpu get name
:: Advanced: List installed software
wmic product get name,version
```

16. **whoami**\
    Shows current user.

```cmd
:: Basic: Display username
whoami
:: Advanced: Get user SID
whoami /user
```

17. **tasklist**\
    Lists running processes.

```cmd
:: Basic: Show all processes
tasklist
:: Advanced: Filter specific process
tasklist /fi "IMAGENAME eq notepad.exe"
```

#### Network Commands

18. **ipconfig**\
    Shows IP configuration.

```cmd
:: Basic: Display IP details
ipconfig
:: Advanced: Release and renew IP
ipconfig /release && ipconfig /renew
```

19. **ping**\
    Tests network connectivity.

```cmd
:: Basic: Ping a website
ping google.com
:: Advanced: Continuous ping
ping -t google.com
```

20. **tracert**\
    Traces route to a host.

```cmd
:: Basic: Trace to domain
tracert google.com
:: Advanced: Trace without DNS
tracert -d 8.8.8.8
```

21. **netstat**\
    Shows connections/ports.

```cmd
:: Basic: List active connections
netstat -a
:: Advanced: Show process IDs
netstat -a -o
```

22. **nslookup**\
    Queries DNS.

```cmd
:: Basic: Resolve domain
nslookup google.com
:: Advanced: Query specific DNS server
nslookup google.com 8.8.8.8
```

23. **arp**\
    Manages ARP cache.

```cmd
:: Basic: Show ARP table
arp -a
:: Advanced: Delete ARP entry
arp -d 192.168.1.1
```

24. **route**\
    Manages routing table.

```cmd
:: Basic: Display routing table
route print
:: Advanced: Add persistent route
route add 10.0.0.0 MASK 255.255.255.0 192.168.1.1 /p
```

25. **net use**\
    Maps network drives.

```cmd
:: Basic: Map a drive
net use Z: \\server\share
:: Advanced: Map with credentials
net use Z: \\server\share /user:domain\user password
```

26. **netstat -an**\
    Shows connections numerically.

```cmd
:: Basic: List listening ports
netstat -an | find "LISTENING"
:: Advanced: Log connections
netstat -an > netlog.txt
```

27. **netsh**\
    Configures network settings.

```cmd
:: Basic: Show Wi-Fi profiles
netsh wlan show profiles
:: Advanced: Export Wi-Fi profile
netsh wlan export profile name="MyWiFi" folder=C:\WiFi
```

#### Disk and Drive Commands

28. **chkdsk**\
    Checks/repairs disk errors.

```cmd
:: Basic: Scan drive
chkdsk C:
:: Advanced: Fix errors on reboot
chkdsk C: /f /r
```

29. **diskpart**\
    Manages disks/partitions.

```cmd
:: Basic: List disks
diskpart
list disk
:: Advanced: Create partition
diskpart
select disk 1
create partition primary
```

30. **format**\
    Formats a drive.

```cmd
:: Basic: Format USB
format D: /fs:NTFS
:: Advanced: Quick format with label
format D: /fs:NTFS /q /v:MyUSB
```

31. **label**\
    Sets volume label.

```cmd
:: Basic: Change label
label D: MyDrive
:: Advanced: Remove label
label D:
```

32. **vol**\
    Shows volume info.

```cmd
:: Basic: Display volume details
vol C:
:: Advanced: Pipe to file
vol C: > volume.txt
```

33. **fsutil**\
    Manages file system.

```cmd
:: Basic: Check drive type
fsutil fsinfo drivetype C:
:: Advanced: Disable 8.3 names
fsutil 8dot3name set C: 0
```

#### Task and Process Management Commands

34. **taskkill**\
    Terminates processes.

```cmd
:: Basic: Kill process by name
taskkill /IM notepad.exe
:: Advanced: Force-kill by PID
taskkill /PID 1234 /F
```

* **Investigation Context**: Detect malicious `taskkill` use (e.g., targeting `MsMpEng.exe`) in Defender XDR/Sentinel.

```kql
DeviceProcessEvents
| where ProcessCommandLine contains "taskkill /IM MsMpEng.exe"
| project Timestamp, DeviceName, ProcessCommandLine
```

35. **schtasks**\
    Manages scheduled tasks.

```cmd
:: Basic: Create daily task
schtasks /create /tn MyTask /tr notepad.exe /sc daily
:: Advanced: Delete task
schtasks /delete /tn MyTask /f
```

36. **sc**\
    Controls services.

```cmd
:: Basic: Check service status
sc query wuauserv
:: Advanced: Start a service
sc start wuauserv
```

37. **shutdown**\
    Performs shutdown/restart/logoff.

```cmd
:: Basic: Shutdown in 60s
shutdown /s /t 60
:: Advanced: Cancel shutdown
shutdown /a
```

38. **start**\
    Starts program in new window.

```cmd
:: Basic: Open Notepad
start notepad
:: Advanced: Open URL in browser
start https://google.com
```

39. **pause**\
    Pauses batch file.

```cmd
:: Basic: Pause script
pause
:: Advanced: Pause with message
echo Pausing... & pause
```

40. **timeout**\
    Adds delay in scripts.

```cmd
:: Basic: Wait 10 seconds
timeout /t 10
:: Advanced: Non-interactive wait
timeout /t 10 /nobreak
```

#### User and Security Commands

41. **net user**\
    Manages user accounts.

```cmd
:: Basic: Add user
net user JohnDoe Pass123 /add
:: Advanced: Disable user
net user JohnDoe /active:no
```

42. **net localgroup**\
    Manages group memberships.

```cmd
:: Basic: Add to Administrators
net localgroup Administrators JohnDoe /add
:: Advanced: List group members
net localgroup Administrators
```

43. **runas**\
    Runs program as another user.

```cmd
:: Basic: Run Notepad as Admin
runas /user:Admin notepad.exe
:: Advanced: Run with saved credentials
runas /user:Admin /savecred notepad.exe
```

44. **cacls**\
    Modifies file permissions.

```cmd
:: Basic: Grant read access
cacls file.txt /e /p Everyone:r
:: Advanced: Deny write access
cacls file.txt /e /d Everyone
```

45. **icacls**\
    Advanced file permissions.

```cmd
:: Basic: Grant full control
icacls file.txt /grant Users:F
:: Advanced: Remove permissions
icacls file.txt /remove Users
```

46. **lock**\
    Locks workstation.

```cmd
:: Basic: Lock session
rundll32.exe user32.dll,LockWorkStation
:: Advanced: Lock in script
echo Locking... & rundll32.exe user32.dll,LockWorkStation
```

47. **gpupdate**\
    Updates Group Policy.

```cmd
:: Basic: Refresh policy
gpupdate
:: Advanced: Force user and computer policy
gpupdate /force /target:both
```

48. **secedit**\
    Applies security templates.

```cmd
:: Basic: Export current config
secedit /export /cfg sec.cfg
:: Advanced: Apply template
secedit /configure /db secedit.sdb /cfg security.inf
```

#### Power and Shutdown Commands

49. **powercfg**\
    Manages power settings.

```cmd
:: Basic: Generate battery report
powercfg /batteryreport
:: Advanced: Set power plan
powercfg /setactive 381b4222-f694-41f0-9685-ff5bb260df2e
```

50. **shutdown /s /t 0**\
    Immediate shutdown.

```cmd
:: Basic: Shutdown now
shutdown /s /t 0
:: Advanced: Shutdown with message
shutdown /s /t 0 /c "System maintenance"
```

51. **shutdown /r /t 0**\
    Immediate restart.

```cmd
:: Basic: Restart now
shutdown /r /t 0
:: Advanced: Restart with message
shutdown /r /t 0 /c "Applying updates"
```

52. **shutdown /l**\
    Logs off user.

```cmd
:: Basic: Log off
shutdown /l
:: Advanced: Log off in script
echo Logging off... & shutdown /l
```

#### Windows Troubleshooting Commands

53. **sfc /scannow**\
    Repairs system files.

```cmd
:: Basic: Scan and repair
sfc /scannow
:: Advanced: Verify specific file
sfc /verifyfile C:\Windows\System32\kernel32.dll
```

54. **DISM**\
    Repairs Windows images.

```cmd
:: Basic: Check health
DISM /Online /Cleanup-Image /CheckHealth
:: Advanced: Restore health
DISM /Online /Cleanup-Image /RestoreHealth
```

55. **cleanmgr**\
    Launches disk cleanup.

```cmd
:: Basic: Open cleanup GUI
cleanmgr
:: Advanced: Auto-clean temporary files
cleanmgr /sagerun:1
```

56. **eventvwr**\
    Opens Event Viewer.

```cmd
:: Basic: Launch Event Viewer
eventvwr
:: Advanced: Open specific log
eventvwr /c:System
```

57. **msinfo32**\
    Shows system info.

```cmd
:: Basic: Open System Information
msinfo32
:: Advanced: Export to file
msinfo32 /report sysinfo.txt
```

#### Advanced and Miscellaneous Commands

58. **tree**\
    Displays folder structure.

```cmd
:: Basic: Show folder tree
tree C:\Data
:: Advanced: Include files
tree C:\Data /f
```

59. **echo**\
    Displays messages or toggles echoing.

```cmd
:: Basic: Print message
echo Hello, World!
:: Advanced: Disable echoing
echo off
```

60. **cls**\
    Clears CMD screen.

```cmd
:: Basic: Clear screen
cls
:: Advanced: Clear in script
echo Clearing... & cls
```

61. **title**\
    Sets CMD window title.

```cmd
:: Basic: Set title
title My Script
:: Advanced: Dynamic title
title Backup_%DATE%
```

62. **color**\
    Changes CMD colors.

```cmd
:: Basic: Green text on black
color 0A
:: Advanced: Blue on white
color 1F
```

63. **exit**\
    Closes Command Prompt.

```cmd
:: Basic: Exit CMD
exit
:: Advanced: Exit with code
exit /b 1
```

64. **prompt**\
    Changes CMD prompt.

```cmd
:: Basic: Set default prompt
prompt $P$G
:: Advanced: Custom prompt
prompt $T$G
```

65. **help**\
    Shows command help.

```cmd
:: Basic: Help for dir
help dir
:: Advanced: List all commands
help
```

#### CMD Scripting and Batch Commands

66. **if**\
    Conditional logic in scripts.

```cmd
:: Basic: Check file existence
if exist file.txt echo Found
:: Advanced: Compare values
if %ERRORLEVEL%==0 echo Success
```

67. **for**\
    Loops through values.

```cmd
:: Basic: List .txt files
for %f in (*.txt) do echo %f
:: Advanced: Process files in script
for /R %%f in (*.txt) do copy %%f D:\Backup
```

68. **goto**\
    Jumps to labeled line.

```cmd
:: Basic: Jump to end
goto :end
:end
echo Done
:: Advanced: Conditional jump
if %ERRORLEVEL%==1 goto :error
:error
echo Failed
```

69. **call**\
    Calls another script/function.

```cmd
:: Basic: Call script
call myscript.bat
:: Advanced: Call subroutine
call :subroutine
:subroutine
echo Subroutine
```

70. **setlocal / endlocal**\
    Manages variable scope.

```cmd
:: Basic: Local variable
setlocal
set MYVAR=123
endlocal
:: Advanced: Preserve variable
setlocal EnableDelayedExpansion
set MYVAR=!DATE!
endlocal & set GLOBALVAR=%MYVAR%
```

#### Bonus Useful Commands

71. **clip**\
    Redirects to clipboard.

```cmd
:: Basic: Copy dir output
dir | clip
:: Advanced: Copy system info
systeminfo | clip
```

72. **find**\
    Searches text in files.

```cmd
:: Basic: Find text
find "error" log.txt
:: Advanced: Case-sensitive search
find /i "error" log.txt
```

73. **assoc**\
    Manages file associations.

```cmd
:: Basic: Show .txt association
assoc .txt
:: Advanced: Set association
assoc .txt=txtfile
```

74. **driverquery**\
    Lists installed drivers.

```cmd
:: Basic: List drivers
driverquery
:: Advanced: Export to CSV
driverquery /fo csv > drivers.csv
```

75. **taskview**\
    Opens Task View.

{% code overflow="wrap" %}
```cmd
:: Basic: Launch Task View
explorer.exe shell:::{3080F90E-D7AD-11D9-BD98-0000947B0257}
:: Advanced: Scripted launch
echo Opening Task View... & explorer.exe shell:::{3080F90E-D7AD-11D9-BD98-0000947B0257}
```
{% endcode %}
