# 70+ Essential Powershell Commands

### File and Directory Commands

1. **Get-ChildItem** (Windows: dir)\
   Lists files/directories.

```powershell
# Basic: List files with details
Get-ChildItem -Path .
# Advanced: List .txt files recursively
Get-ChildItem -Path . -Recurse -Include *.txt | Format-Table Name, Length
```

2. **Set-Location** (Windows: cd)\
   Changes directory.

```powershell
# Basic: Navigate to a folder
Set-Location -Path C:\Users
# Advanced: Switch to path with spaces
Set-Location -Path "C:\Program Files (x86)"
```

3. **New-Item -ItemType Directory** (Windows: mkdir/md)\
   Creates a directory.

```powershell
# Basic: Create a single folder
New-Item -Path Data -ItemType Directory
# Advanced: Create nested folders
New-Item -Path Parent\Child\Grandchild -ItemType Directory -Force
```

4. **Remove-Item -Directory** (Windows: rmdir/rd)\
   Deletes a directory.

```powershell
# Basic: Remove empty folder
Remove-Item -Path Data -Directory
# Advanced: Remove non-empty folder
Remove-Item -Path Data -Recurse -Force
```

5. **Remove-Item** (Windows: del)\
   Deletes files.

```powershell
# Basic: Delete a file
Remove-Item -Path temp.txt
# Advanced: Delete all .log files silently
Remove-Item -Path *.log -Force
```

6. **Copy-Item** (Windows: copy)\
   Copies files.

```powershell
# Basic: Copy a file
Copy-Item -Path file.txt -Destination D:\Backup
# Advanced: Copy multiple files with overwrite
Copy-Item -Path *.txt -Destination D:\Backup -Force
```

7. **Copy-Item -Recurse** (Windows: xcopy)\
   Copies directories recursively.

```powershell
# Basic: Copy a directory
Copy-Item -Path Data -Destination D:\Backup
# Advanced: Copy with hidden files
Copy-Item -Path Data -Destination D:\Backup -Recurse -Force
```

8. **Move-Item** (Windows: move)\
   Moves/renames files.

```powershell
# Basic: Move a file
Move-Item -Path file.txt -Destination D:\Archive
# Advanced: Rename multiple files
Get-ChildItem *.txt | Rename-Item -NewName { $_.Name -replace '.txt','.bak' }
```

9. **Set-ItemProperty -Name Attributes** (Windows: attrib)\
   Changes file attributes.

{% code overflow="wrap" %}
```powershell
# Basic: Hide a file
Set-ItemProperty -Path secret.txt -Name Attributes -Value Hidden
# Advanced: Make folder read-only and hidden
Set-ItemProperty -Path Data -Name Attributes -Value ([System.IO.FileAttributes]::ReadOnly + [System.IO.FileAttributes]::Hidden)
```
{% endcode %}

10. **Rename-Item** (Windows: ren)\
    Renames files/directories.

```powershell
# Basic: Rename a file
Rename-Item -Path old.txt -NewName new.txt
# Advanced: Bulk rename files
Get-ChildItem *2023*.txt | Rename-Item -NewName { $_.Name -replace '2023','2024' }
```

### System Information Commands

11. **Get-ComputerInfo** (Windows: systeminfo)\
    Shows system information.

```powershell
# Basic: Display OS name
Get-ComputerInfo | Select-Object WindowsProductName
# Advanced: Export system info to file
Get-ComputerInfo | Export-Csv -Path sysinfo.csv
```

12. **$env:COMPUTERNAME** (Windows: hostname)\
    Shows computer name.

```powershell
# Basic: Get hostname
$env:COMPUTERNAME
# Advanced: Log hostname
$env:COMPUTERNAME | Out-File device.txt
```

13. **Get-CimInstance Win32\_OperatingSystem** (Windows: ver)\
    Shows OS version.

```powershell
# Basic: Check version
Get-CimInstance Win32_OperatingSystem | Select-Object Version
# Advanced: Filter specific version
(Get-CimInstance Win32_OperatingSystem).Version -match "10.0"
```

14. **Get-ChildItem Env:** (Windows: set)\
    Manages environment variables.

```powershell
# Basic: View all variables
Get-ChildItem Env:
# Advanced: Add custom path
$env:PATH += ";C:\Tools"
```

15. **Get-CimInstance** (Windows: wmic)\
    Queries system details.

```powershell
# Basic: Get CPU info
Get-CimInstance Win32_Processor | Select-Object Name
# Advanced: List installed software
Get-CimInstance Win32_Product | Select-Object Name, Version
```

16. **$env:USERNAME** (Windows: whoami)\
    Shows current user.

```powershell
# Basic: Display username
$env:USERNAME
# Advanced: Get user SID
(Get-CimInstance Win32_ComputerSystem).UserName
```

17. **Get-Process** (Windows: tasklist)\
    Lists running processes.

```powershell
# Basic: Show all processes
Get-Process
# Advanced: Filter specific process
Get-Process -Name notepad
```

### Network Commands

18. **Get-NetIPAddress** (Windows: ipconfig)\
    Shows network configuration.

```powershell
# Basic: Display IP details
Get-NetIPAddress
# Advanced: Refresh network adapter
Restart-NetAdapter -Name Ethernet
```

19. **Test-Connection** (Windows: ping)\
    Tests network connectivity.

{% code overflow="wrap" %}
```powershell
# Basic: Ping a website
Test-Connection google.com
# Advanced: Continuous ping with timestamp
while ($true) { Test-Connection google.com -Count 1 | Select-Object @{n='Time';e={Get-Date}}, * }
```
{% endcode %}

20. **Test-NetConnection** (Windows: tracert)\
    Tests route to a host.

```powershell
# Basic: Trace to domain
Test-NetConnection google.com -TraceRoute
# Advanced: Trace with no DNS
Test-NetConnection 8.8.8.8 -TraceRoute
```

21. **Get-NetTCPConnection** (Windows: netstat)\
    Shows network connections/ports.

```powershell
# Basic: List active connections
Get-NetTCPConnection
# Advanced: Show process IDs
Get-NetTCPConnection | Select-Object LocalPort, OwningProcess
```

22. **Resolve-DnsName** (Windows: nslookup)\
    Queries DNS.

```powershell
# Basic: Resolve domain
Resolve-DnsName google.com
# Advanced: Query specific DNS server
Resolve-DnsName google.com -Server 8.8.8.8
```

23. **Get-NetNeighbor** (Windows: arp)\
    Manages ARP cache.

```powershell
# Basic: Show ARP table
Get-NetNeighbor
# Advanced: Remove ARP entry
Remove-NetNeighbor -IPAddress 192.168.1.1
```

24. **Get-NetRoute** (Windows: route)\
    Manages routing table.

```powershell
# Basic: Display routing table
Get-NetRoute
# Advanced: Add persistent route
New-NetRoute -DestinationPrefix 10.0.0.0/24 -NextHop 192.168.1.1 -RouteMetric 1
```

25. **New-PSDrive** (Windows: net use)\
    Maps network drives.

{% code overflow="wrap" %}
```powershell
# Basic: Map a drive
New-PSDrive -Name Z -PSProvider FileSystem -Root \\server\share
# Advanced: Map with credentials
New-PSDrive -Name Z -PSProvider FileSystem -Root \\server\share -Credential (Get-Credential)
```
{% endcode %}

26. **Get-NetTCPConnection -State Listen** (Windows: netstat -an)\
    Shows listening connections.

```powershell
# Basic: List listening ports
Get-NetTCPConnection -State Listen
# Advanced: Log connections
Get-NetTCPConnection -State Listen | Out-File netlog.txt
```

27. **Set-NetIPInterface** (Windows: netsh)\
    Configures network settings.

```powershell
# Basic: Show network interfaces
Get-NetIPInterface
# Advanced: Enable DHCP
Set-NetIPInterface -InterfaceAlias Wi-Fi -Dhcp Enabled
```

### Disk and Drive Commands

28. **Repair-Volume** (Windows: chkdsk)\
    Checks/repairs disk errors.

```powershell
# Basic: Scan drive
Repair-Volume -DriveLetter C
# Advanced: Fix errors offline
Repair-Volume -DriveLetter C -OfflineScanAndFix
```

29. **Get-Disk | New-Partition** (Windows: diskpart)\
    Manages disks/partitions.

```powershell
# Basic: List disks
Get-Disk
# Advanced: Create partition
New-Partition -DiskNumber 1 -UseMaximumSize -AssignDriveLetter
```

30. **Initialize-Disk | Format-Volume** (Windows: format)\
    Formats a drive.

```powershell
# Basic: Format to NTFS
Format-Volume -DriveLetter D -FileSystem NTFS
# Advanced: Quick format with label
Format-Volume -DriveLetter D -FileSystem NTFS -NewFileSystemLabel MyUSB -Force
```

31. **Set-Volume** (Windows: label)\
    Sets volume label.

```powershell
# Basic: Change label
Set-Volume -DriveLetter D -NewFileSystemLabel MyDrive
# Advanced: Remove label
Set-Volume -DriveLetter D -NewFileSystemLabel ""
```

32. **Get-Volume** (Windows: vol)\
    Shows volume info.

```powershell
# Basic: Display volume details
Get-Volume -DriveLetter C
# Advanced: Pipe to file
Get-Volume | Out-File volume.txt
```

33. **Optimize-Volume** (Windows: fsutil)\
    Manages filesystem properties.

```powershell
# Basic: Check drive health
Get-Volume -DriveLetter C | Select-Object HealthStatus
# Advanced: Defragment drive
Optimize-Volume -DriveLetter C
```

### Task and Process Management Commands

34. **Stop-Process** (Windows: taskkill)\
    Terminates processes.

```powershell
# Basic: Stop process by name
Stop-Process -Name notepad
# Advanced: Force-stop by ID
Stop-Process -Id 1234 -Force
```

* **Investigation Context**: Monitor in Defender XDR/Sentinel. KQL query:

```kql
DeviceProcessEvents
| where ProcessCommandLine contains "Stop-Process"
| project Timestamp, DeviceName, ProcessCommandLine
```

35. **Register-ScheduledTask** (Windows: schtasks)\
    Manages scheduled tasks.

{% code overflow="wrap" %}
```powershell
# Basic: Create daily task
Register-ScheduledTask -TaskName MyTask -Action (New-ScheduledTaskAction -Execute notepad) -Trigger (New-ScheduledTaskTrigger -Daily -At 9AM)
# Advanced: Delete task
Unregister-ScheduledTask -TaskName MyTask -Confirm:$false
```
{% endcode %}

36. **Get-Service** (Windows: sc)\
    Controls services.

```powershell
# Basic: Check service status
Get-Service -Name wuauserv
# Advanced: Restart service
Restart-Service -Name wuauserv -Force
```

37. **Stop-Computer** (Windows: shutdown)\
    Performs shutdown/restart.

```powershell
# Basic: Shutdown in 60s
Stop-Computer -Delay 60
# Advanced: Cancel shutdown
Stop-Computer -Cancel
```

38. **Start-Process** (Windows: start)\
    Starts a program.

```powershell
# Basic: Open Notepad
Start-Process notepad
# Advanced: Open URL in browser
Start-Process "https://google.com"
```

39. **Pause** (Windows: pause)\
    Pauses script execution.

```powershell
# Basic: Pause script
Pause
# Advanced: Pause with message
Write-Host "Press Enter to continue..." ; Pause
```

40. **Start-Sleep** (Windows: timeout)\
    Adds delay in scripts.

```powershell
# Basic: Wait 10 seconds
Start-Sleep -Seconds 10
# Advanced: Wait in milliseconds
Start-Sleep -Milliseconds 5000
```

### User and Security Commands

41. **New-LocalUser** (Windows: net user)\
    Manages user accounts.

{% code overflow="wrap" %}
```powershell
# Basic: Add user
New-LocalUser -Name JohnDoe -Password (ConvertTo-SecureString "Pass123" -AsPlainText -Force)
# Advanced: Disable user
Disable-LocalUser -Name JohnDoe
```
{% endcode %}

42. **Add-LocalGroupMember** (Windows: net localgroup)\
    Manages group memberships.

```powershell
# Basic: Add to Administrators
Add-LocalGroupMember -Group Administrators -Member JohnDoe
# Advanced: List group members
Get-LocalGroupMember -Group Administrators
```

43. **Start-Process -Credential** (Windows: runas)\
    Runs command as another user.

```powershell
# Basic: Run as user
Start-Process notepad -Credential (Get-Credential)
# Advanced: Run with saved credentials
Start-Process notepad -Credential (Import-Clixml cred.xml)
```

44. **Set-Acl** (Windows: cacls)\
    Modifies file permissions.

{% code overflow="wrap" %}
```powershell
# Basic: Grant read access
$acl = Get-Acl file.txt; $acl.SetAccessRule((New-Object System.Security.AccessControl.FileSystemAccessRule("Everyone","Read","Allow"))); Set-Acl file.txt $acl
# Advanced: Deny write access
$acl = Get-Acl file.txt; $acl.SetAccessRule((New-Object System.Security.AccessControl.FileSystemAccessRule("Everyone","Write","Deny"))); Set-Acl file.txt $acl
```
{% endcode %}

45. **Set-Acl** (Windows: icacls)\
    Advanced file permissions.

{% code overflow="wrap" %}
```powershell
# Basic: Grant full control
$acl = Get-Acl file.txt; $acl.SetAccessRule((New-Object System.Security.AccessControl.FileSystemAccessRule("Users","FullControl","Allow"))); Set-Acl file.txt $acl
# Advanced: Remove permissions
$acl = Get-Acl file.txt; $acl.RemoveAccessRuleAll((New-Object System.Security.AccessControl.FileSystemAccessRule("Users","FullControl","Allow"))); Set-Acl file.txt $acl
```
{% endcode %}

46. **Lock-Computer** (Windows: lock)\
    Locks workstation.

```powershell
# Basic: Lock session
Lock-Computer
# Advanced: Lock in script
Write-Host "Locking..." ; Lock-Computer
```

47. **Update-GP** (Windows: gpupdate)\
    Updates Group Policy.

```powershell
# Basic: Refresh policy
gpupdate
# Advanced: Force user and computer policy
gpupdate /force
```

48. **Set-GPRegistryValue** (Windows: secedit)\
    Applies security settings.

{% code overflow="wrap" %}
```powershell
# Basic: Export GPO settings
Get-GPO -All | Export-Csv gpo.csv
# Advanced: Set registry policy
Set-GPRegistryValue -Name "Default Domain Policy" -Key "HKLM\Software\Policies" -ValueName "Test" -Type String -Value "Enabled"
```
{% endcode %}

### Power and Shutdown Commands

49. **Get-CimInstance Win32\_Battery** (Windows: powercfg)\
    Manages power settings.

```powershell
# Basic: Show battery info
Get-CimInstance Win32_Battery
# Advanced: Export power report
powercfg /batteryreport; Get-Content battery-report.html
```

50. **Stop-Computer -Force** (Windows: shutdown /s /t 0)\
    Immediate shutdown.

```powershell
# Basic: Shutdown now
Stop-Computer -Force
# Advanced: Shutdown with message
Stop-Computer -Force -Comment "System maintenance"
```

51. **Restart-Computer -Force** (Windows: shutdown /r /t 0)\
    Immediate restart.

```powershell
# Basic: Restart now
Restart-Computer -Force
# Advanced: Restart with message
Restart-Computer -Force -Comment "Applying updates"
```

52. **Logoff** (Windows: shutdown /l)\
    Logs off user.

```powershell
# Basic: Log off
logoff
# Advanced: Log off in script
Write-Host "Logging off..." ; logoff
```

### Troubleshooting Commands

53. **Repair-WindowsImage** (Windows: sfc /scannow)\
    Repairs system files.

```powershell
# Basic: Scan and repair
sfc /scannow
# Advanced: Verify specific file
sfc /verifyfile C:\Windows\System32\kernel32.dll
```

54. **Repair-WindowsImage** (Windows: DISM)\
    Repairs Windows images.

```powershell
# Basic: Check health
Repair-WindowsImage -Online -CheckHealth
# Advanced: Restore health
Repair-WindowsImage -Online -RestoreHealth
```

55. **Clear-Disk** (Windows: cleanmgr)\
    Manages disk space.

```powershell
# Basic: Run disk cleanup
cleanmgr
# Advanced: Auto-clean temporary files
cleanmgr /sagerun:1
```

56. **Get-WinEvent** (Windows: eventvwr)\
    Views event logs.

```powershell
# Basic: Show recent logs
Get-WinEvent -LogName System -MaxEvents 10
# Advanced: Filter by event ID
Get-WinEvent -LogName System -FilterHashtable @{Id=4688}
```

57. **Get-ComputerInfo** (Windows: msinfo32)\
    Shows system info.

```powershell
# Basic: Display system info
Get-ComputerInfo
# Advanced: Export to file
Get-ComputerInfo | Out-File sysinfo.txt
```

### Advanced and Miscellaneous Commands

58. **Get-ChildItem -Recurse** (Windows: tree)\
    Displays folder structure.

```powershell
# Basic: Show folder tree
Get-ChildItem -Path C:\Data | Format-Wide
# Advanced: Include files recursively
Get-ChildItem -Path C:\Data -Recurse
```

59. **Write-Output** (Windows: echo)\
    Displays messages or writes to files.

```powershell
# Basic: Print message
Write-Output "Hello, World!"
# Advanced: Append to file
Write-Output "Log entry" | Out-File log.txt -Append
```

60. **Clear-Host** (Windows: cls)\
    Clears console screen.

```powershell
# Basic: Clear screen
Clear-Host
# Advanced: Clear in script
Write-Host "Clearing..." ; Clear-Host
```

61. **$host.UI.RawUI.WindowTitle** (Windows: title)\
    Sets console title.

```powershell
# Basic: Set title
$host.UI.RawUI.WindowTitle = "My Script"
# Advanced: Dynamic title
$host.UI.RawUI.WindowTitle = "Backup_$((Get-Date).ToString('yyyy-MM-dd'))"
```

62. **$PSStyle** (Windows: colour)\
    Changes console colours (PowerShell 7+).

```powershell
# Basic: Green text
$PSStyle.Foreground.Green
# Advanced: Blue on white
$PSStyle.Foreground.Blue; $PSStyle.Background.White
```

63. **Exit** (Windows: exit)\
    Closes PowerShell session.

```powershell
# Basic: Exit session
Exit
# Advanced: Exit with code
Exit 1
```

64. **$PSCommandPath** (Windows: prompt)\
    Customises PowerShell prompt.

```powershell
# Basic: Set simple prompt
function prompt { "PS> " }
# Advanced: Custom colored prompt
function prompt { "$([char]27)[32m$env:USERNAME@$env:COMPUTERNAME> " }
```

65. **Get-Help** (Windows: help)\
    Shows command help.

```powershell
# Basic: Help for Get-ChildItem
Get-Help Get-ChildItem
# Advanced: Search help topics
Get-Help *list*
```

### Scripting and Shell Commands

66. **If** (Windows: if)\
    Conditional logic in scripts.

```powershell
# Basic: Check file existence
if (Test-Path file.txt) { Write-Output "Found" }
# Advanced: Check command success
if ($LASTEXITCODE -eq 0) { Write-Output "Success" }
```

67. **ForEach-Object** (Windows: for)\
    Loops through values.

{% code overflow="wrap" %}
```powershell
# Basic: List .txt files
Get-ChildItem *.txt | ForEach-Object { $_.Name }
# Advanced: Copy files recursively
Get-ChildItem -Recurse -Include *.txt | ForEach-Object { Copy-Item $_.FullName D:\Backup }
```
{% endcode %}

68. **Function** (Windows: goto)\
    Defines functions for script flow.

{% code overflow="wrap" %}
```powershell
# Basic: Define function
function MyFunc { Write-Output "Done" }; MyFunc
# Advanced: Conditional function call
if ($LASTEXITCODE -eq 1) { function Error { Write-Output "Failed" }; Error } else { Write-Output "OK" }
```
{% endcode %}

69. **. (dot sourcing)** (Windows: call)\
    Calls another script/function.

```powershell
# Basic: Source script
. .\myscript.ps1
# Advanced: Source with parameters
. .\myscript.ps1 -Arg1 value
```

70. **$script: / $local:** (Windows: setlocal/endlocal)\
    Manages variable scope.

```powershell
# Basic: Local variable
function MyFunc { $local:var = 123; Write-Output $var }; MyFunc
# Advanced: Preserve variable
function MyFunc { $local:var = Get-Date; $var | Out-File out.txt }; MyFunc
```

### Bonus Useful Commands

71. **Set-Clipboard** (Windows: clip)\
    Copies to clipboard.

```powershell
# Basic: Copy dir output
Get-ChildItem | Set-Clipboard
# Advanced: Copy system info
Get-ComputerInfo | Set-Clipboard
```

72. **Select-String** (Windows: find)\
    Searches text in files.

```powershell
# Basic: Find text
Select-String "error" log.txt
# Advanced: Case-insensitive recursive search
Select-String "error" -Path *.txt -Recurse -CaseSensitive:$false
```

73. **Get-ItemProperty** (Windows: assoc)\
    Manages file associations.

```powershell
# Basic: Show .txt association
Get-ItemProperty HKLM:\Software\Classes\.txt
# Advanced: Set association
Set-ItemProperty HKLM:\Software\Classes\.txt -Name PerceivedType -Value text
```

74. **Get-CimInstance Win32\_PnPSignedDriver** (Windows: driverquery)\
    Lists drivers.

```powershell
# Basic: List drivers
Get-CimInstance Win32_PnPSignedDriver
# Advanced: Export to CSV
Get-CimInstance Win32_PnPSignedDriver | Export-Csv drivers.csv
```

75. **Show-Command explorer** (Windows: taskview)\
    Opens Task View (GUI-based).

{% code overflow="wrap" %}
```powershell
# Basic: Launch Task View
explorer.exe shell:::{3080F90E-D7AD-11D9-BD98-0000947B0257}
# Advanced: Scripted launch
Write-Host "Opening Task View..." ; explorer.exe shell:::{3080F90E-D7AD-11D9-BD98-0000947B0257}
```
{% endcode %}
